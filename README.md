# cuping-project

![1](https://github.com/cuping-project/cuping-fe/assets/55288856/912c0f95-b3e2-469c-bf90-1288efe435b9)
> 데모영상
> https://www.youtube.com/watch?v=53dH4lfc2Lw

## **요약**

>

- 커핑은 근처 지역에서 좋아하는 원두를 찾아 즐길 수 있는 원두 기반 카페 검색 서비스입니다.
- `일반 사용자`는 지역 기반 검색을 통해 원두 기반으로 카페를 찾고 검색하실 수 있습니다.
- `카페 관리자`는 본인 가게에서 보유하고 있는 원두를 등록하고, 가게 정보도 등록하실 수 있습니다.

## **역할**

- 인원
  - BE 4명
    - 전정훈, 최한준, 장기웅, 김재형
  - FE 3명
    - 전정훈, 최민재, 김연주
  - DE 1명
    - 김은진

## 개발환경

### FE

- React( +Typescript )
  - React는 컴포넌트 기반의 프론트엔드 라이브러리로, **개발 효율성**과 **유지 보수성**을 향상시키는 데 도움이 됩니다.
    Typescript는 JavaScript의 superset으로, 정적 타입 체크를 통해 **안정성**을 높이며 개발 시 실수를
    줄일 수
    있습니다.
- vite ( +swc )
  - Vite는 빠른 개발 서버 시작과 `HMR(Hot Module Replacement)`를 제공하여 개발 효율성을
    향상시킵니다. SWC는 TypeScript와 JSX를 매우 빠른 속도로 **JavaScript로 변환하는 컴파일러**
    로, 빌드 시간을 크게 줄일 수 있습니다.
- Axios
  - HTTP 통신을 간편하게 수행할 수 있도록 돕는 라이브러리로, Promise 기반으로 동작해 비동기 처리를 쉽게
    합니다.
- Recoil
  - 상태 관리 라이브러리로, 전역 상태 관리를 효율적으로 할 수 있습니다.
- React-query
  - 서버 상태를 비동기적으로 가져오고 캐시하는 데 사용하는 라이브러리로, **데이터 동기화 및 캐싱, 배경 업데이트,
    페이징** 등을 손쉽게 수행할 수 있습니다.
- TailwindCSS
  - CSS 프레임워크로, `유틸리티 클래스`를 활용한 접근 방식으로 디자인 시스템을 쉽게 구축하고 반응형 디자인을 빠르게
    개발할 수 있게 해줍니다.
- CI/CD
  - CI/CD 파이프라인을 구축하고 유지 관리하는 데 사용하였습니다. 이를 통해 개발 효율성을 향상시키고 배포 과정에서의 실수를
    방지하였습니다.

## 구현 기능 및 성과

- 로그인, 회원가입 로직 구현
- 필터링 구현
- 댓글 페이지네이션 구현
- 좋아요 기능 구현
- GithubAction / AWS CodeDeploy를 통한 CI/CD 환경 구축

## 트러블 슈팅

### 회원가입시, 사용자 경험(UX) 및 서버 유효성 검사 로직 문제

> 문제

사장님 회원가입을 완료하고 로그인을 시도했을 때, 로그인이 되지 않는 문제가 발생하였습니다. 사용자로부터는 회원가입이
정상적으로 완료된 것처럼 보였지만, 실제로는 서버에서 회원가입 처리가 제대로 이루어지지 않았습니다.
> 원인

문제의 원인은 서버에서 회원 가입을 처리하는 로직과 사용자 경험(UX)에 있었습니다.

회원 가입 요청이 서버에 전송되고, 서버는 이 요청을 정상적으로 받아 처리했으므로, 사용자는 회원 가입이 성공적으로 이루어진 것으로
인식하였습니다.

하지만, 실제로는 서버의 비밀번호 유효성 검사 로직을 통과하지 못했기 때문에 회원 가입이 완료되지 않았습니다. 서버는 이에 대한 에러
메시지를 사용자에게 전달하지 않았고, 이로 인해 사용자는 문제를 인식하지 못했습니다.
> 해결 과정 및 결과

사장님 회원가입을 완료하고 로그인을 시도했을 때, 로그인이 되지 않는 문제가 발생하였습니다.

사용자로부터는 회원가입이 정상적으로 완료된 것처럼 보였지만, 실제로는 서버에서 회원가입 처리가 제대로 이루어지지 않았습니다.

### 로그인 토큰의 저장 방식과 관련된 문제

> 문제

서버에서 클라이언트의 쿠키를 관리하려고 할 때, 여러 문제들이 발생하였습니다. 가장 큰 문제점은 토큰의 만료로 인해 사용자가 로그인을 다시
해야 하는 상황이었습니다.

이런 경우, 사용자에게 불편을 주며, 동시에 서버에도 부담을 줍니다. 또한, 로그인 후의 워크플로우가 복잡해져서 사용자의 경험을 저하시켰고,
서버에서 처리되는 리다이렉팅 때문에 문제를 핸들링하기가 어려웠습니다.

> 원인

이러한 문제들의 주요 원인은 서버 중심의 토큰 관리 구조였습니다.

이 구조에서 쿠키의 재발급 및 관리는 서버에서 이루어지므로 비효율적이었고, 토큰이 만료될 경우 사용자 경험에도 부정적인 영향을 미쳤습니다.
또한, 서버가 클라이언트의 쿠키를 관리하려고 하면, 보안상의 문제도 있었습니다.
> 해결 과정 및 결과

문제를 해결하기 위해, 로그인 기능 구현 시에 보안성과 서버 부하를 중요하게 고려하였습니다. 클라이언트 측에서 직접 쿠키를 관리하도록 바꾸었고,
이를 위해 **`js-cookie`** 라이브러리를 활용하였습니다.

클라이언트에서 쿠키에 토큰을 저장하고, 로그인 상태를 클라이언트에서 확인하도록 했습니다.

이로써, 토큰의 만료 시점을 계산하고 만료될 경우 쿠키에서 토큰을 삭제하는 과정은 모두 클라이언트에서 처리하게 되었습니다. 이를 통해 토큰의
유효성 관리를 효율화하였고, 서버 부하 감소와 보안 강화를 동시에 달성하였습니다.

또한, 로그인 상태 체크 및 로그인 상태 시 메인 페이지로 이동하는 설정을 통해 사용자 경험을 개선하였습니다. 이런 해결 방안을 통해 시스템의
효율성과 안정성을 향상시키는 데 성공하였습니다.

### 사용자가 '좋아요'를 누른 후 페이지를 새로 고침하면, 해당 '좋아요'의 상태가 초기화되는 문제

> 문제

사용자가 '좋아요'를 눌렀을 때 해당 상태가 유지되지 않고, 페이지를 새로 고침하면 초기화되는 문제가 발생하였습니다. 이는 사용자가 자신이
누른 '좋아요'의 상태를 유지하고 싶을 때 불편함을 초래하였습니다.
> 원인

문제의 원인은 API 통신과 관련이 있었습니다. '좋아요' 상태의 변경은 서버의 'like' 상태에만 영향을 미쳤으며, 로그인 상태에 따라 '
좋아요' 상태를 렌더링하는 로직이 존재하지 않았습니다.

이로 인해 사용자가 '좋아요'를 눌렀지만, 로그인 상태가 바뀌거나 페이지가 새로 고침되면 해당 상태가 초기화되었습니다.
> 해결 과정 및 결과

이 문제를 해결하기 위해 클라이언트에서 '좋아요' 상태를 가져오는 로직을 변경하였습니다. React의 `useEffect` 훅을
사용하여, 종속성 배열 내에 'loggedin' 상태를 추가하였습니다.

이 변경으로 인해 '좋아요' 상태는 이제 로그인 상태에 따라 렌더링되며, 사용자가 '좋아요'를 누른 상태가 페이지 새로 고침 후에도 유지됩니다.
이로써 사용자 경험을 개선하였습니다.

### 사용자가 설정한 지역 정보가 새로고침을 할 때마다 사라지는 현상

> 문제

Home에서 사용자가 지역을 설정하고 원두를 눌러 Detail 페이지로 이동한 후에 페이지를 새로고침하면, 지도에 표시된 내용이 사라지는 문제가
발생하였습니다. 이로 인해 사용자는 자신이 설정한 지역 정보를 계속해서 재설정해야만 했습니다.
> 원인

문제의 원인은 전역 상태 관리에 있었습니다. 사용자가 선택한 시/구 정보를 전역으로 관리하였는데, 이 상태가 페이지 새로고침시마다 초기화되어
사라지는 현상이 있었습니다. 이로 인해 사용자는 지도에 표시된 내용이 사라져 자신이 설정한 지역 정보를 재확인하기 어려웠습니다.
> 해결 과정 및 결과

이 문제를 해결하기 위해 `localStorage` 또는 `sessionStorage`에 사용자가 선택한 지역 정보를
저장하였습니다. 이를 통해 페이지 새로고침 후에도 사용자의 지역 설정이 유지되도록 하였습니다.

해결 과정에서 `useEffect`와 `selectorFamily`을 활용해보았으나, 초기 홈화면 자체가 로드되지 않는 문제가
발생하였습니다.

이 문제를 해결함으로써, 사용자가 페이지를 새로고침하더라도 자신이 설정한 지역 정보를 유지할 수 있게 되었습니다. 이로써 사용자 경험이
개선되었습니다. 그러나 전역 상태 관리에 대한 더 깊은 이해와 해결 방법에 대한 추가적인 연구가 필요함을 인지하였습니다.

## 시기

- 프로젝트 진행 기간
  - 2023.5 ~ 2023.6 (6주)
